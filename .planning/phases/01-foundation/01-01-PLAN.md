---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [CMakeLists.txt, src/gdpdu_extension.cpp, src/include/gdpdu_extension.hpp, Makefile, .gitmodules, vcpkg.json]
autonomous: true

must_haves:
  truths:
    - "Extension compiles without errors using CMake"
    - "Extension can be loaded in DuckDB via LOAD statement"
    - "Extension outputs confirmation on successful load"
  artifacts:
    - path: "CMakeLists.txt"
      provides: "Build configuration for DuckDB extension"
      contains: "duckdb_extension_load"
    - path: "src/gdpdu_extension.cpp"
      provides: "Main extension entry point with load/init functions"
      contains: "DUCKDB_EXTENSION_MAIN"
    - path: "src/include/gdpdu_extension.hpp"
      provides: "Extension header with class declaration"
      min_lines: 10
  key_links:
    - from: "CMakeLists.txt"
      to: "duckdb"
      via: "FetchContent or submodule"
      pattern: "duckdb"
    - from: "src/gdpdu_extension.cpp"
      to: "DuckDB API"
      via: "extension registration macro"
      pattern: "DUCKDB_EXTENSION_MAIN"
---

<objective>
Set up the DuckDB C++ extension scaffolding for the GDPdU importer.

Purpose: Create the foundation for all subsequent extension development — a compilable, loadable extension.
Output: Working extension skeleton that compiles and loads in DuckDB.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize DuckDB extension project structure</name>
  <files>CMakeLists.txt, src/gdpdu_extension.cpp, src/include/gdpdu_extension.hpp, Makefile, .gitmodules, vcpkg.json, .github/workflows/MainDistributionPipeline.yml</files>
  <action>
Clone the official DuckDB extension template (https://github.com/duckdb/extension-template) structure.

Create the following files:

1. **CMakeLists.txt** — Use DuckDB extension CMake pattern:
   - Set minimum CMake version 3.12
   - Set project name to "gdpdu"
   - Include FetchContent for DuckDB
   - Use `duckdb_extension_load` to register extension
   - Link against DuckDB

2. **src/gdpdu_extension.cpp** — Main extension file:
   - Include duckdb.hpp and extension header
   - Implement `GdpduExtension` class inheriting `duckdb::Extension`
   - Implement `Load(DuckDB &db)` method — for now just prints "GDPdU extension loaded"
   - Use `DUCKDB_EXTENSION_MAIN` macro with "gdpdu" name

3. **src/include/gdpdu_extension.hpp** — Header file:
   - Include duckdb/extension.hpp
   - Declare `GdpduExtension` class with Load method

4. **Makefile** — Build helper:
   - `make` target to build release
   - `make debug` for debug build
   - `make test` for running tests
   - Use standard CMake build pattern (mkdir build, cmake, make)

5. **vcpkg.json** — For pugixml dependency (needed later for XML parsing):
   - Add pugixml as dependency

6. **.gitmodules** — Reference DuckDB submodule (optional, FetchContent preferred)

Use the extension naming convention: extension name is "gdpdu", files are gdpdu_extension.cpp.
  </action>
  <verify>All files exist: CMakeLists.txt, src/gdpdu_extension.cpp, src/include/gdpdu_extension.hpp, Makefile</verify>
  <done>Extension project structure created with all required files</done>
</task>

<task type="auto">
  <name>Task 2: Build and verify extension loads</name>
  <files>build/</files>
  <action>
Build the extension and verify it works:

1. Create build directory: `mkdir -p build`
2. Run CMake: `cmake -B build -DCMAKE_BUILD_TYPE=Release`
3. Build: `cmake --build build --config Release`
4. Locate built extension (.duckdb_extension or .dll on Windows)

If CMake fails finding DuckDB, ensure FetchContent is properly configured to download DuckDB.

After successful build:
- Start DuckDB CLI (if available) or write a test script
- Try: `LOAD 'path/to/gdpdu.duckdb_extension';`
- Verify extension loads without error

Note: On Windows, extension file is .dll. On Linux/Mac, it's .duckdb_extension.
  </action>
  <verify>cmake --build build --config Release completes with exit code 0; extension file exists in build directory</verify>
  <done>Extension builds successfully and can be loaded in DuckDB</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] CMakeLists.txt exists and references DuckDB
- [ ] src/gdpdu_extension.cpp implements DUCKDB_EXTENSION_MAIN
- [ ] src/include/gdpdu_extension.hpp declares GdpduExtension class
- [ ] `cmake --build build` succeeds without errors
- [ ] Extension file (.duckdb_extension or .dll) exists in build output
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Extension compiles without errors
- Extension file is produced
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
